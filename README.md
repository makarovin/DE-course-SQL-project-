# DE-course-SQL-project
Итоговый проект курса Data Engineer. 
Суть проекта: Разработать ETL процесс, получающий ежедневную выгрузку данных (предоставляется за 3 дня), загружающий ее в хранилище данных и ежедневно строящий отчет. 
По результатам загрузки ежедневно необходимо строить витрину отчетности по мошенническим операциям. 
Витрина строится накоплением, каждый новый отчет укладывается в эту же таблицу с новым report_dt.

**Признаки мошеннических операций:** 
  1. Совершение операции при просроченном или заблокированном паспорте. 
  2. Совершение операции при недействующем договоре. 
  3. Совершение операций в разных городах в течение одного часа. 
  4. Попытка подбора суммы. В течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней. 
  Последняя операция (успешная) в такой цепочке считается мошеннической. 
  
**Обработка файлов**

##### Выгружаемые файлы именуются согласно следующему шаблону:
  transactions_DDMMYYYY.txt
  
  passport_blacklist_DDMMYYYY.xlsx
  
  terminals_DDMMYYYY.xlsx
  
Предполагается что в один день приходит по одному такому файлу. После загрузки соответствующего файла он должен быть переименован в файл с расширением .backup чтобы при следующем запуске файл не искался и перемещен в каталог archive:
  transactions_DDMMYYYY.txt.backup
  passport_blacklist_DDMMYYYY.xlsx.backup
  terminals_DDMMYYYY.xlsx.backup
